import{a as h}from"./chunk-Y3PIQJ2O.js";import{a as de,b as ce,c as pe,d as fe,e as ue,f as _e,g as xe,h as he,i as Ce,j as ge,k as ve,l as Me,m as be,n as Ee}from"./chunk-TCLZS4QV.js";import{a as se}from"./chunk-UZLBYMZW.js";import{a as me,b as D}from"./chunk-2WW4ZDK7.js";import"./chunk-QQUIUFGX.js";import{$ as a,Aa as f,Ac as ee,Ba as u,Bc as te,C as b,Cc as ie,Da as R,Ec as ne,Fa as S,Fc as re,Ga as p,Hc as I,Ic as oe,K as _,L as x,Mc as ae,Na as j,Oa as o,Pa as m,Pc as w,Qa as W,Qc as le,Rc as T,Sa as H,Ta as L,Ua as N,Va as z,Wa as v,Ya as V,Za as O,_a as $,da as A,ha as B,hc as Q,ia as E,ib as G,jb as J,jc as y,la as s,lb as q,lc as X,mb as P,oa as d,oc as Y,rc as Z,vb as K,xa as i,xb as M,ya as n,yc as U,za as k}from"./chunk-YXSU4V5K.js";var ye=()=>["/cards/my-decks"],Se=()=>["name","date","game_name","event_type","tournament_type","position","points"];function Ie(e,r){if(e&1){let t=R();i(0,"mat-card",5)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Perfil del Usuario"),n()(),i(4,"mat-card-content")(5,"div",6)(6,"label"),o(7,"Nombre de usuario:"),n(),i(8,"span"),o(9),n()(),i(10,"div",6)(11,"label"),o(12,"Correo electr\xF3nico:"),n(),i(13,"span"),o(14),n()(),i(15,"div",6)(16,"label"),o(17,"Biograf\xEDa:"),n(),i(18,"span"),o(19),n()(),i(20,"div",6)(21,"label"),o(22,"Rol:"),n(),i(23,"span"),o(24),n()()(),i(25,"mat-card-actions",7)(26,"button",8),S("click",function(){_(t);let l=p();return x(l.toggleEdit())}),o(27,"Modificar"),n(),i(28,"button",9),o(29,"Mis decks"),n()()()}if(e&2){let t=p();a(9),m(t.username),a(5),m(t.email),a(5),m(t.bio||"No especificada"),a(5),m(t.role==="player"?"Jugador":"Tienda"),a(4),d("routerLink",v(5,ye))}}function we(e,r){if(e&1){let t=R();i(0,"mat-card",5)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Editar Perfil"),n()(),i(4,"mat-card-content")(5,"mat-form-field",10)(6,"mat-label"),o(7,"Correo electr\xF3nico"),n(),i(8,"input",11),N("ngModelChange",function(l){_(t);let g=p();return L(g.email,l)||(g.email=l),x(l)}),n()(),i(9,"mat-form-field",10)(10,"mat-label"),o(11,"Biograf\xEDa"),n(),i(12,"textarea",12),N("ngModelChange",function(l){_(t);let g=p();return L(g.bio,l)||(g.bio=l),x(l)}),n()()(),i(13,"mat-card-actions",7)(14,"button",8),S("click",function(){_(t);let l=p();return x(l.saveProfile())}),o(15,"Guardar cambios"),n(),i(16,"button",13),S("click",function(){_(t);let l=p();return x(l.toggleEdit())}),o(17,"Cancelar"),n(),i(18,"button",9),o(19,"Mis decks"),n()()()}if(e&2){let t=p();a(8),H("ngModel",t.email),a(4),H("ngModel",t.bio),a(6),d("routerLink",v(3,ye))}}function Te(e,r){e&1&&(i(0,"th",26),o(1,"Evento"),n())}function De(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.name)}}function Fe(e,r){e&1&&(i(0,"th",26),o(1,"Fecha"),n())}function ke(e,r){if(e&1&&(i(0,"td",27),o(1),V(2,"date"),n()),e&2){let t=r.$implicit;a(),m(O(2,1,t.date,"dd/MM/yy"))}}function Re(e,r){e&1&&(i(0,"th",26),o(1,"Juego"),n())}function He(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.game_name)}}function Le(e,r){e&1&&(i(0,"th",26),o(1,"Tipo"),n())}function Ne(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.event_type)}}function Ve(e,r){e&1&&(i(0,"th",26),o(1,"Modelo"),n())}function Oe(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.tournament_type||"-")}}function Ae(e,r){e&1&&(i(0,"th",26),o(1,"Puesto"),n())}function Be(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.position||"-")}}function je(e,r){e&1&&(i(0,"th",26),o(1,"Puntos"),n())}function We(e,r){if(e&1&&(i(0,"td",27),o(1),n()),e&2){let t=r.$implicit;a(),m(t.points||"-")}}function ze(e,r){e&1&&k(0,"tr",28)}function $e(e,r){e&1&&k(0,"tr",29)}function Ge(e,r){if(e&1&&(i(0,"table",14),f(1,15),s(2,Te,2,0,"th",16)(3,De,2,1,"td",17),u(),f(4,18),s(5,Fe,2,0,"th",16)(6,ke,3,4,"td",17),u(),f(7,19),s(8,Re,2,0,"th",16)(9,He,2,1,"td",17),u(),f(10,20),s(11,Le,2,0,"th",16)(12,Ne,2,1,"td",17),u(),f(13,21),s(14,Ve,2,0,"th",16)(15,Oe,2,1,"td",17),u(),f(16,22),s(17,Ae,2,0,"th",16)(18,Be,2,1,"td",17),u(),f(19,23),s(20,je,2,0,"th",16)(21,We,2,1,"td",17),u(),s(22,ze,1,0,"tr",24)(23,$e,1,0,"tr",25),n()),e&2){let t=p();d("dataSource",t.history),a(22),d("matHeaderRowDef",v(3,Se)),a(),d("matRowDefColumns",v(4,Se))}}function Je(e,r){e&1&&(i(0,"div")(1,"p"),o(2,"No hay historial de participaci\xF3n."),n()())}function qe(e,r){if(e&1&&(i(0,"mat-list-item")(1,"mat-icon",31),o(2,"emoji_events"),n(),i(3,"div",32),o(4),n(),i(5,"div",33),o(6),n(),i(7,"div",33),o(8),V(9,"date"),n()()),e&2){let t=r.$implicit;a(4),m(t.name),a(2),m(t.description),a(2),W("Obtenido: ",O(9,3,t.date_earned,"dd/MM/yy"),"")}}function Ke(e,r){if(e&1&&(i(0,"mat-list"),s(1,qe,10,6,"mat-list-item",30),n()),e&2){let t=p();a(),d("ngForOf",t.achievements)}}function Qe(e,r){e&1&&(i(0,"div")(1,"p"),o(2,"No tienes logros todav\xEDa."),n()())}var C=class e{constructor(r){this.userService=r}username=null;email=null;bio=null;role=null;isEditing=!1;history=[];achievements=[];ngOnInit(){this.loadProfileAndExtras()}loadProfileAndExtras(){this.userService.getUserProfile().subscribe({next:r=>{this.username=r.username,this.email=r.email,this.bio=r.bio||"",this.role=r.role,this.username&&(this.userService.getUserHistory(this.username).subscribe(t=>this.history=t),this.userService.getUserAchievements(this.username).subscribe(t=>this.achievements=t))},error:r=>{console.error("Error al cargar el perfil del usuario:",r),alert("Hubo un problema al cargar los datos del perfil. Por favor, int\xE9ntalo m\xE1s tarde.")}})}toggleEdit(){this.isEditing=!this.isEditing}saveProfile(){if(!this.email||!this.email.includes("@")){alert("Por favor, introduce un correo electr\xF3nico v\xE1lido.");return}let r={email:this.email,bio:this.bio||""};this.userService.updateProfile(r).subscribe({next:()=>{alert("Perfil actualizado con \xE9xito"),this.isEditing=!1,this.username&&(this.userService.getUserHistory(this.username).subscribe(t=>this.history=t),this.userService.getUserAchievements(this.username).subscribe(t=>this.achievements=t))},error:t=>{console.error("Error al actualizar el perfil:",t),alert("Hubo un error al actualizar el perfil. Por favor, int\xE9ntalo m\xE1s tarde.")}})}static \u0275fac=function(t){return new(t||e)(A(h))};static \u0275cmp=B({type:e,selectors:[["app-user-profile"]],features:[z([h])],decls:17,vars:6,consts:[["editMode",""],["class","user-profile-card",4,"ngIf","ngIfElse"],[1,"user-profile-card","mt-4"],["mat-table","","class","mat-elevation-z1 full-width-table",3,"dataSource",4,"ngIf"],[4,"ngIf"],[1,"user-profile-card"],[1,"profile-field"],[1,"event-actions-nav"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","","color","primary",3,"routerLink"],["appearance","fill",1,"full-width"],["matInput","","type","email",3,"ngModelChange","ngModel"],["matInput","",3,"ngModelChange","ngModel"],["mat-stroked-button","","color","warn",3,"click"],["mat-table","",1,"mat-elevation-z1","full-width-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","game_name"],["matColumnDef","event_type"],["matColumnDef","tournament_type"],["matColumnDef","position"],["matColumnDef","points"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[4,"ngFor","ngForOf"],["matListIcon","","color","accent"],["matLine",""],["matLine","",1,"mat-caption"]],template:function(t,c){if(t&1&&(s(0,Ie,30,6,"mat-card",1)(1,we,20,4,"ng-template",null,0,$),i(3,"mat-card",2)(4,"mat-card-header")(5,"mat-card-title"),o(6,"Historial de participaci\xF3n"),n()(),i(7,"mat-card-content"),s(8,Ge,24,5,"table",3)(9,Je,3,0,"div",4),n()(),i(10,"mat-card",2)(11,"mat-card-header")(12,"mat-card-title"),o(13,"Logros"),n()(),i(14,"mat-card-content"),s(15,Ke,2,1,"mat-list",4)(16,Qe,3,0,"div",4),n()()),t&2){let l=j(2);d("ngIf",!c.isEditing)("ngIfElse",l),a(8),d("ngIf",c.history.length>0),a(),d("ngIf",c.history.length===0),a(6),d("ngIf",c.achievements.length>0),a(),d("ngIf",c.achievements.length===0)}},dependencies:[P,G,J,q,U,X,Y,Z,y,Q,I,ee,ne,ie,re,te,T,le,ae,oe,w,D,me,M,K,pe,de,ce,Ee,fe,_e,ge,xe,ue,ve,he,Ce,Me,be],styles:[".user-profile-card[_ngcontent-%COMP%]{margin-bottom:1.5rem}.user-profile-card[_ngcontent-%COMP%]{max-width:600px;margin:20px auto;padding:20px}.full-width[_ngcontent-%COMP%]{width:100%}mat-card-header[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:10px;border-radius:4px}"]})};var Xe=[{path:"",component:C,canActivate:[se]}],F=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=E({type:e});static \u0275inj=b({imports:[M.forChild(Xe),M]})};var Ue=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=E({type:e});static \u0275inj=b({providers:[h],imports:[P,U,F,C,I,y,T,w,D]})};export{Ue as UserProfileModule};
